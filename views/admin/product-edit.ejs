<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="icon" href="./icon2.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="../../styles/product-edit.css">
    <link rel="stylesheet" href="../../styles/partials/sidebar.css">
    <title>edit product</title>
</head>
<body>
<div class="admin-page">
    <%- include("../admin-partials//header") %>

    <main>
        <%- include("../admin-partials//sidebar") %>

        <section>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/admin/products">Products</a></li>
                    <li class="breadcrumb-item active" aria-current="page"><%= product.name %></li>
                </ol>
            </nav>      
                <form action="/admin/product/<%= product._id%>/edit" method="post">
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com" name="brand" value="<%= product.brand%>">
                        <label for="floatingInput">Brand</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com"accept="" value="<%= product.name%>" name="name">
                        <label for="floatingInput">Name</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com"accept="" value="<%= product.image %>" name="image" disabled>
                        <label for="floatingInput">Image</label>
                    </div>
                    <div class="mb-3">
                        <label for="formFile" class="form-label">Default file input example</label>
                        <input class="form-control" type="file" id="formFile" name="image">
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com"accept="" value="<%= product.category%>" name="category">
                        <label for="floatingInput">Category</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com"accept="" value="<%= product.description%>" name="description">
                        <label for="floatingInput">Description</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com"accept="" value="<%= product.price%>" name="price">
                        <label for="floatingInput">Price</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com"accept="" value="<%= product.countInStock%>" name="countInStock">
                        <label for="floatingInput">Count in stock</label>
                    </div>
                    <button
                        class="btn btn-primary"
                        type="submit"
                    >
                        Save
                    </button>
                </form>
            

            <form
            class="mt-3"
                method="post"
                action="/admin/product/<%= product._id %>/remove"
            >
                <button
                    class="btn btn-danger"
                    id="remove-btn"
                    value="<%=  product._id %>"
                    type="submit"
                >
                    Delete
                </button>
        </form>
        </section>
    </main>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
<script>
    const fileInput = document.getElementById('formFile')

    fileInput.addEventListener('change', loadImage)

    function loadImage () {
        var data, xhr;

        data = new FormData();
        data.append('image', fileInput.files[0]);

        xhr = new XMLHttpRequest();

        xhr.open(
            'POST',
            '/image/upload',
            true
        );
     
        xhr.send(data);
    }
</script>
</body>
</html>